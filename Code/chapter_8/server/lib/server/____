defmodule MyFSM do
  use GenServer
  require Logger

  def start_link(order) do
    GenServer.start_link(__MODULE__, :ok, name: __MODULE__)
  end

  def init(:ok, state) do
    {:ok, state}
  end

  def handle_call({:transition, state, event}, _from, _data) do
    {:reply, transition(state, event), state}
  end

  defp transition(:init, :start) do
    :started
  end

  defp transition(:started, :stop) do
    :stopped
  end

  defp transition(:stopped, :start) do
    :started
  end

  defp transition(state, _event) do
    state
  end
end
